(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{492:(e,a,r)=>{"use strict";r.d(a,{p:()=>i});var s=r(95155),t=r(12115),l=r(59434);let i=t.forwardRef((e,a)=>{let{className:r,type:t,...i}=e;return(0,s.jsx)("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:a,...i})});i.displayName="Input"},25930:(e,a,r)=>{"use strict";r.d(a,{J:()=>d});var s=r(95155),t=r(12115),l=r(40968),i=r(74466),n=r(59434);let o=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef((e,a)=>{let{className:r,...t}=e;return(0,s.jsx)(l.b,{ref:a,className:(0,n.cn)(o(),r),...t})});d.displayName=l.b.displayName},59434:(e,a,r)=>{"use strict";r.d(a,{cn:()=>l});var s=r(52596),t=r(39688);function l(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return(0,t.QP)((0,s.$)(a))}},78496:(e,a,r)=>{"use strict";r.d(a,{$:()=>d});var s=r(95155),t=r(12115),l=r(99708),i=r(74466),n=r(59434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=t.forwardRef((e,a)=>{let{className:r,variant:t,size:i,asChild:d=!1,...m}=e,c=d?l.DX:"button";return(0,s.jsx)(c,{className:(0,n.cn)(o({variant:t,size:i,className:r})),ref:a,...m})});d.displayName="Button"},79964:(e,a,r)=>{Promise.resolve().then(r.bind(r,83551))},83551:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>c});var s=r(95155),t=r(12115),l=r(35695),i=r(78496),n=r(492),o=r(25930),d=r(95108),m=r(16961);let c=()=>{let e=(0,l.useRouter)(),[a,r]=(0,t.useState)(!1),[c,u]=(0,t.useState)(!0),[h,f]=(0,t.useState)(""),[p,g]=(0,t.useState)(""),[b,x]=(0,t.useState)(""),[v,N]=(0,t.useState)(0),[y,j]=(0,t.useState)({firstName:"",lastName:"",email:"",name:"",address:"",phoneNumber:"",username:""});(0,t.useEffect)(()=>{(async()=>{try{let i=localStorage.getItem("access_token"),n=localStorage.getItem("userId");if(!i||!n)return void e.push("/CustomerAuth");x(n);let o=await fetch("https://api.grayscale-technologies.com/api/v1/customers/".concat(n,"/"),{headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"}});if(o.ok){var a,r,s,t,l;let e=await o.json();x(e.id.toString()),N((null==(a=e.user)?void 0:a.id)||0),j({firstName:(null==(r=e.user)?void 0:r.first_name)||"",lastName:(null==(s=e.user)?void 0:s.last_name)||"",email:e.email||(null==(t=e.user)?void 0:t.email)||"",name:e.name||"",address:e.address||"",phoneNumber:e.phone_number||"",username:(null==(l=e.user)?void 0:l.username)||""})}else f("Failed to load profile data")}catch(e){console.error("Error fetching profile:",e),f("Failed to load profile data")}finally{u(!1)}})()},[e]);let w=e=>{let{name:a,value:r}=e.target;j(e=>({...e,[a]:r}))},S=async a=>{if(a.preventDefault(),f(""),g(""),!y.firstName||!y.lastName||!y.email||!y.name)return void f("Please fill in all required fields");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y.email))return void f("Please enter a valid email address");r(!0);try{let a=localStorage.getItem("access_token");if(!a||!b)return void f("Authentication required");let r={user:{id:v,username:y.username||"user_".concat(y.phoneNumber),first_name:y.firstName,last_name:y.lastName,email:y.email},name:y.name,phone_number:y.phoneNumber,email:y.email,address:y.address||""},i=await fetch("https://api.grayscale-technologies.com/api/v1/customers/".concat(b,"/"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(r)});if(i.ok){var s,t,l;let a=await i.json();localStorage.setItem("firstName",(null==(s=a.user)?void 0:s.first_name)||""),localStorage.setItem("lastName",(null==(t=a.user)?void 0:t.last_name)||""),localStorage.setItem("displayName",a.name||""),localStorage.setItem("email",a.email||(null==(l=a.user)?void 0:l.email)||""),window.dispatchEvent(new Event("storage")),window.dispatchEvent(new CustomEvent("loginStatusChanged")),g("Profile updated successfully!"),setTimeout(()=>{e.push("/Dashboard")},2e3)}else{let e=await i.json();f(e.message||e.detail||"Failed to update profile")}}catch(e){console.error("Error updating profile:",e),f("Network error. Please try again.")}finally{r(!1)}};return c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.default,{}),(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center bg-white rounded-xl p-8 shadow-lg",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading profile..."})]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.default,{}),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Edit Profile"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Update your personal information"})]}),p&&(0,s.jsx)(d.A,{message:"Success",description:p,type:"success",showIcon:!0,className:"mb-6"}),h&&(0,s.jsx)(d.A,{message:"Error",description:h,type:"error",showIcon:!0,className:"mb-6"}),(0,s.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"firstName",children:"First Name *"}),(0,s.jsx)(n.p,{id:"firstName",name:"firstName",value:y.firstName,onChange:w,placeholder:"First name",className:"mt-1 border-gray-300 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"lastName",children:"Last Name *"}),(0,s.jsx)(n.p,{id:"lastName",name:"lastName",value:y.lastName,onChange:w,placeholder:"Last name",className:"mt-1 border-gray-300 focus:border-blue-500",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"name",children:"Display Name *"}),(0,s.jsx)(n.p,{id:"name",name:"name",value:y.name,onChange:w,placeholder:"How should we call you?",className:"mt-1 border-gray-300 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"email",children:"Email Address *"}),(0,s.jsx)(n.p,{id:"email",name:"email",type:"email",value:y.email,onChange:w,placeholder:"your@email.com",className:"mt-1 border-gray-300 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"phoneNumber",children:"Phone Number"}),(0,s.jsx)(n.p,{id:"phoneNumber",name:"phoneNumber",type:"tel",value:y.phoneNumber,onChange:w,placeholder:"01XXXXXXXXX",className:"mt-1 border-gray-300 focus:border-blue-500",disabled:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Phone number cannot be changed"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.J,{htmlFor:"address",children:"Address"}),(0,s.jsx)(n.p,{id:"address",name:"address",value:y.address,onChange:w,placeholder:"Enter your address",className:"mt-1 border-gray-300 focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,s.jsx)(i.$,{type:"submit",disabled:a,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-medium py-3",children:a?(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Save Changes"}),(0,s.jsx)(i.$,{type:"button",onClick:()=>e.push("/Dashboard"),className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-3",children:"Cancel"})]})]})]})})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[66,309,907,352,693,961,441,684,358],()=>a(79964)),_N_E=e.O()}]);